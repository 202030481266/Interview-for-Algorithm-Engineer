# 目录
- [1.全连接层的作用](#user-content-1全连接层的作用)
- [2.介绍一下MLP网络](#user-content-2介绍一下MLP网络)

<h2 id="1全连接层的作用">1.全连接层的作用</h2>

全连接层将卷积学习到的高维特征映射到label空间，可以作为整个网络的<font color=DeepSkyBlue>分类器</font>模块。

虽然全连接层参数存在冗余的情况，但是在模型进行迁移学习时，其能保持较大的模型capacity。

目前很多模型使用全局平均池化（GAP）取代全连接层以减小模型参数，并且依然能达到SOTA的性能。

<h2 id="2.介绍一下MLP网络">2.介绍一下MLP网络</h2>

多层感知器（Multilayer Perceptron, MLP）可以说是最基本的神经网络，由Frank Rosenblatt于1957提出，一直广泛应用于各种机器学习和深度学习任务中。

在传统深度学习时代，由于卷积神经网络的出现，一定程度上MLP网络的使用频率有所减少，但是在Transformer发布后，MLP结构重新站上AI行业的舞台。**在现在的AIGC时代中，MLP结构已经成为AIGC模型的重要组成部分**。

下面是Rocky对MLP网络的详细讲解：

### 1. MLP的基本结构

MLP由一个输入层、一个或多个隐藏层和一个输出层组成。每一层都包含多个神经元（或节点），这些神经元之间是全连接的，即每个神经元的输出连接到下一层的每个神经元。

#### 1.1 输入层

输入层的神经元数等于输入数据的特征数。如果输入是一个包含28x28像素的图像，则输入层的神经元数为784。

#### 1.2 隐藏层

隐藏层由一个或多个层组成，每层包含若干个神经元。隐藏层的数量和每层的神经元数是超参数，我们可以根据不同的场景进行对应的设置。隐藏层通过激活函数（如ReLU、Sigmoid、Tanh等）引入非线性，使得MLP能够学习复杂的分布和特征。

#### 1.3 输出层

输出层的神经元数取决于具体的AI任务。例如，对于二分类任务，输出层通常包含一个神经元；对于多分类任务，输出层的神经元数等于类别数。

### 2. MLP的工作原理

MLP的工作原理基于前向传播和反向传播两个过程。

#### 2.1 前向传播

在前向传播过程中，输入数据通过网络层层传递，经过每一层的加权和激活函数计算，最终得到输出结果。具体步骤如下：

1. **加权求和**：每个神经元接收前一层的输出，通过权重进行加权求和，并加上一个偏置项。
   
  $$z_j = \sum_i w_{ij} \cdot x_i + b_j$$
     
  其中， $w_{ij}$ 是权重， $x_i$ 是输入， $b_j$ 是偏置项。

3. **激活函数**：对加权求和的结果应用激活函数，引入非线性。
   
  $$a_j = \sigma(z_j)$$
   
  其中， $\sigma$ 是激活函数，常见的激活函数包括ReLU、Sigmoid和Tanh等。

4. **输出**：将激活函数的输出传递给下一层，直到最后一层得到最终输出。

#### 2.2 反向传播

在反向传播过程中，网络通过计算损失函数的梯度来更新权重和偏置项，以最小化预测误差。具体步骤如下：

1. **损失函数**：计算网络的输出与实际标签之间的损失。常见的损失函数包括均方误差（MSE）和交叉熵损失。

  $$L = \frac{1}{2} \sum_i (y_i - \hat{y}_i)^2$$

  其中， $y_i$ 是实际标签， $\hat{y}_i$ 是网络输出。

2. **梯度计算**：通过链式法则计算每个权重和偏置项的梯度。

  $$\frac{\partial L}{\partial w_{ij}} = \frac{\partial L}{\partial a_j} \cdot \frac{\partial a_j}{\partial z_j} \cdot \frac{\partial z_j}{\partial w_{ij}}$$

4. **权重更新**：使用梯度下降算法更新权重和偏置项。

  $$w_{ij} = w_{ij} - \eta \cdot \frac{\partial L}{\partial w_{ij}}$$

  其中， $\eta$ 是学习率。

